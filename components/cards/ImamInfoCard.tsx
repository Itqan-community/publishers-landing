'use client';

import React, { useState, useEffect } from 'react';
import Image from 'next/image';

/** Person/muslim silhouette for avatar fallback â€” Tahbeer style */
const PersonIcon = ({ className }: { className?: string }) => (
  <svg viewBox="0 0 24 24" fill="none" className={className} aria-hidden="true">
    <path
      d="M12 12C14.7614 12 17 9.76142 17 7C17 4.23858 14.7614 2 12 2C9.23858 2 7 4.23858 7 7C7 9.76142 9.23858 12 12 12Z"
      stroke="currentColor"
      strokeWidth="2"
      strokeLinecap="round"
      strokeLinejoin="round"
    />
    <path
      d="M20.59 22C20.59 18.13 16.74 15 12 15C7.26 15 3.41 18.13 3.41 22"
      stroke="currentColor"
      strokeWidth="2"
      strokeLinecap="round"
      strokeLinejoin="round"
    />
  </svg>
);

export interface ImamInfoCardProps {
  label: string;
  name: string;
  bio: string;
  avatarSrc?: string;
}

/**
 * Tahbeer imam info card (Figma node 4023:454).
 * RTL: avatar (circle) | label + name | opening quote | bio | closing quote.
 */
export const ImamInfoCard: React.FC<ImamInfoCardProps> = ({
  label,
  name,
  bio,
  avatarSrc,
}) => {
  const [imageError, setImageError] = useState(false);
  useEffect(() => setImageError(false), [avatarSrc]);
  const showImage = avatarSrc?.trim() && !imageError;

  return (
    <div
      className="flex flex-col sm:flex-row sm:items-center gap-4 sm:gap-6 rounded-[16px] sm:rounded-[20px] border border-[#e7e7e7] bg-white p-4 sm:p-6 text-start shadow-[0px_14px_44px_rgba(0,0,0,0.07)]"
      dir="rtl"
    >
      {/* 1. Avatar + label/name row on mobile; same row on desktop */}
      <div className="flex flex-row items-center gap-4 sm:gap-6 shrink-0 justify-center">
        <div
          className="flex h-16 w-16 sm:h-[97px] sm:w-[97px] flex-shrink-0 items-center justify-center rounded-full bg-[#EEF9F2]"
          aria-hidden
        >
          {showImage ? (
            <Image
              src={avatarSrc!}
              alt=""
              width={97}
              height={97}
              className="h-full w-full rounded-full object-cover"
              onError={() => setImageError(true)}
            />
          ) : (
            // <PersonIcon className="h-8 w-8 sm:h-12 sm:w-12 text-[#6a6a6a]" />
            <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path opacity="0.3" d="M24.0017 4C19.5648 4 16.1031 7.65829 16.0039 11.9896L31.9995 11.9896C31.9003 7.65828 28.4386 4 24.0017 4Z" fill="#A67851"/>
              <g opacity="0.3">
              <path d="M24 31.9981C24.0604 31.9981 24.1206 31.9969 24.1805 31.9946C24.4923 31.9825 24.6481 31.9765 26.3241 30.2343C27.1824 29.342 27.6011 28.6505 27.8054 27.9258L28 27.9981C34.4873 29.851 37.7309 30.7775 39.7078 33.1657C39.8994 33.3972 40.0804 33.6371 40.2504 33.8848C41.7669 36.0951 41.9722 38.9154 42 43.9981L6 43.9981C6.02779 38.9154 6.2331 36.0951 7.74962 33.8848C7.91957 33.6371 8.1006 33.3972 8.29217 33.1657C10.2691 30.7775 13.5127 29.851 20 27.9981L20.1972 27.9351C20.4025 28.6564 20.8213 29.3458 21.6759 30.2343C23.3519 31.9765 23.5077 31.9825 23.8195 31.9946C23.8794 31.9969 23.9396 31.9981 24 31.9981Z" fill="#A67851"/>
              <path d="M24.1805 31.9946L24.2297 33.2629L24.2297 33.2629L24.1805 31.9946ZM23.8195 31.9946L23.7703 33.2629L23.7703 33.2629L23.8195 31.9946ZM26.3241 30.2343L25.4094 29.3544V29.3544L26.3241 30.2343ZM21.6759 30.2343L20.7612 31.1142V31.1142L21.6759 30.2343ZM20 27.9981L20.3486 29.2185L20.3676 29.2131L20.3865 29.2071L20 27.9981ZM8.29217 33.1657L9.26988 33.9751V33.9751L8.29217 33.1657ZM7.74962 33.8848L6.70304 33.1667L6.70304 33.1667L7.74962 33.8848ZM6 43.9981L4.73079 43.9912L4.72381 45.2673H6L6 43.9981ZM28 27.9981L27.5579 29.1878L27.6041 29.205L27.6514 29.2185L28 27.9981ZM39.7078 33.1657L38.7301 33.9751L38.7301 33.9751L39.7078 33.1657ZM40.2504 33.8848L41.297 33.1667L41.297 33.1667L40.2504 33.8848ZM42 43.9981V45.2673L43.2762 45.2673L43.2692 43.9912L42 43.9981ZM27.8054 27.9258L28.2475 26.736L26.9572 26.2566L26.5838 27.5814L27.8054 27.9258ZM20.1972 27.9351L21.418 27.5877L21.0593 26.327L19.8108 26.7261L20.1972 27.9351ZM24.1805 31.9946L24.1313 30.7263C24.0878 30.728 24.044 30.7289 24 30.7289V31.9981V33.2673C24.0768 33.2673 24.1534 33.2658 24.2297 33.2629L24.1805 31.9946ZM23.8195 31.9946L23.7703 33.2629C23.8466 33.2658 23.9232 33.2673 24 33.2673V31.9981V30.7289C23.956 30.7289 23.9122 30.728 23.8687 30.7263L23.8195 31.9946ZM24.1805 31.9946L24.2297 33.2629C24.3071 33.2599 24.547 33.2562 24.8289 33.158C25.0925 33.0662 25.3161 32.9218 25.5139 32.7698C25.8889 32.4817 26.4106 31.9751 27.2388 31.1142L26.3241 30.2343L25.4094 29.3544C24.5616 30.2356 24.1674 30.6032 23.9675 30.7567C23.878 30.8255 23.8993 30.7938 23.9937 30.7609C24.1063 30.7216 24.2098 30.7233 24.1313 30.7263L24.1805 31.9946ZM23.8195 31.9946L23.8687 30.7263C23.7902 30.7233 23.8937 30.7216 24.0063 30.7609C24.1007 30.7938 24.122 30.8255 24.0325 30.7567C23.8326 30.6032 23.4384 30.2356 22.5906 29.3544L21.6759 30.2343L20.7612 31.1142C21.5894 31.9751 22.1111 32.4817 22.4861 32.7698C22.6839 32.9218 22.9075 33.0662 23.1711 33.158C23.453 33.2562 23.6929 33.2599 23.7703 33.2629L23.8195 31.9946ZM20 27.9981L19.6514 26.7777C16.4347 27.6965 13.9236 28.4119 11.9756 29.2058C10.0002 30.011 8.4858 30.9413 7.31445 32.3564L8.29217 33.1657L9.26988 33.9751C10.0755 33.0019 11.1714 32.2749 12.9338 31.5565C14.7237 30.827 17.0781 30.1527 20.3486 29.2185L20 27.9981ZM8.29217 33.1657L7.31445 32.3564C7.09858 32.6172 6.89457 32.8876 6.70304 33.1667L7.74962 33.8848L8.79619 34.6029C8.94458 34.3866 9.10263 34.1771 9.26988 33.9751L8.29217 33.1657ZM6 43.9981L7.26921 44.005C7.29747 38.8382 7.5381 36.4365 8.79619 34.6029L7.74962 33.8848L6.70304 33.1667C4.9281 35.7537 4.75812 38.9927 4.73079 43.9912L6 43.9981ZM28 27.9981L27.6514 29.2185C30.9219 30.1527 33.2763 30.827 35.0662 31.5565C36.8286 32.2749 37.9245 33.0019 38.7301 33.9751L39.7078 33.1657L40.6856 32.3564C39.5142 30.9413 37.9998 30.011 36.0244 29.2058C34.0764 28.4119 31.5653 27.6965 28.3486 26.7777L28 27.9981ZM39.7078 33.1657L38.7301 33.9751C38.8974 34.1771 39.0554 34.3866 39.2038 34.6029L40.2504 33.8848L41.297 33.1667C41.1054 32.8876 40.9014 32.6172 40.6856 32.3564L39.7078 33.1657ZM42 43.9981L43.2692 43.9912C43.2419 38.9927 43.0719 35.7537 41.297 33.1667L40.2504 33.8848L39.2038 34.6029C40.4619 36.4365 40.7025 38.8382 40.7308 44.005L42 43.9981ZM27.8054 27.9258L26.5838 27.5814C26.4552 28.0375 26.181 28.5522 25.4094 29.3544L26.3241 30.2343L27.2388 31.1142C28.1837 30.1319 28.747 29.2636 29.027 28.2701L27.8054 27.9258ZM27.8054 27.9258L27.3633 29.1155L27.5579 29.1878L28 27.9981L28.4421 26.8084L28.2475 26.736L27.8054 27.9258ZM20.1972 27.9351L18.9764 28.2824C19.2577 29.2711 19.8205 30.1363 20.7612 31.1142L21.6759 30.2343L22.5906 29.3544C21.8221 28.5554 21.5472 28.0418 21.418 27.5877L20.1972 27.9351ZM20.1972 27.9351L19.8108 26.7261L19.6135 26.7891L20 27.9981L20.3865 29.2071L20.5837 29.144L20.1972 27.9351ZM6 43.9981L6 45.2673L42 45.2673V43.9981V42.7289L6 42.7289V43.9981Z" fill="#A67851"/>
              </g>
              <path d="M31.001 18.1165L31.842 13.8058C32.8317 8.73293 29.0467 4 24 4C18.9533 4 15.1683 8.73293 16.158 13.8058L16.999 18.1165C17.6665 21.5375 20.5967 24 24 24C27.4033 24 30.3335 21.5375 31.001 18.1165Z" stroke="#A67851" stroke-width="2.53846" stroke-linecap="round"/>
              <path d="M21.2692 23C21.2692 22.299 20.701 21.7308 20 21.7308C19.299 21.7308 18.7308 22.299 18.7308 23H20H21.2692ZM29.2692 23C29.2692 22.299 28.701 21.7308 28 21.7308C27.299 21.7308 26.7308 22.299 26.7308 23L28 23H29.2692ZM24.1805 31.9965L24.1313 30.7282H24.1313L24.1805 31.9965ZM23.8195 31.9965L23.8687 30.7282H23.8687L23.8195 31.9965ZM26.3241 30.2362L27.2388 31.1161L26.3241 30.2362ZM20 23H18.7308V25.5637H20H21.2692V23H20ZM28 23L26.7308 23V25.5637H28L29.2692 25.5637V23H28ZM24.1805 31.9965L24.1313 30.7282C24.0878 30.7299 24.044 30.7308 24 30.7308L24 32V33.2692C24.0768 33.2692 24.1534 33.2677 24.2297 33.2648L24.1805 31.9965ZM23.8195 31.9965L23.7703 33.2648C23.8466 33.2677 23.9232 33.2692 24 33.2692V32L24 30.7308C23.956 30.7308 23.9122 30.7299 23.8687 30.7282L23.8195 31.9965ZM28 25.5637H26.7308C26.7308 26.5866 26.7208 27.1224 26.5737 27.6182C26.4416 28.0635 26.1638 28.572 25.4094 29.3563L26.3241 30.2362L27.2388 31.1161C28.1602 30.1582 28.7205 29.3072 29.0073 28.3402C29.2792 27.4236 29.2692 26.4943 29.2692 25.5637L28 25.5637ZM24.1805 31.9965L24.2297 33.2648C24.3071 33.2618 24.547 33.2581 24.8289 33.1599C25.0925 33.0681 25.3161 32.9237 25.5139 32.7717C25.8889 32.4836 26.4106 31.977 27.2388 31.1161L26.3241 30.2362L25.4094 29.3563C24.5616 30.2375 24.1674 30.6051 23.9675 30.7586C23.878 30.8274 23.8993 30.7957 23.9937 30.7628C24.1063 30.7235 24.2098 30.7252 24.1313 30.7282L24.1805 31.9965ZM20 25.5637H18.7308C18.7308 26.4943 18.7208 27.4236 18.9927 28.3402C19.2795 29.3072 19.8398 30.1582 20.7612 31.1161L21.6759 30.2362L22.5906 29.3563C21.8362 28.572 21.5584 28.0635 21.4263 27.6182C21.2792 27.1224 21.2692 26.5866 21.2692 25.5637H20ZM23.8195 31.9965L23.8687 30.7282C23.7902 30.7252 23.8937 30.7235 24.0063 30.7628C24.1007 30.7957 24.122 30.8274 24.0325 30.7586C23.8326 30.6051 23.4384 30.2375 22.5906 29.3563L21.6759 30.2362L20.7612 31.1161C21.5894 31.977 22.1111 32.4836 22.4861 32.7717C22.6839 32.9237 22.9075 33.0681 23.1711 33.1599C23.453 33.2581 23.6929 33.2618 23.7703 33.2648L23.8195 31.9965Z" fill="#A67851"/>
              <path d="M20 28C13.5127 29.8529 10.2691 30.7794 8.29217 33.1676C8.1006 33.3991 7.91957 33.639 7.74962 33.8867C6.2331 36.097 6.02779 38.9173 6 44M28 28C34.4873 29.8529 37.7309 30.7794 39.7078 33.1676C39.8994 33.3991 40.0804 33.639 40.2504 33.8867C41.7669 36.097 41.9722 38.9173 42 44" stroke="#A67851" stroke-width="2.53846" stroke-linecap="round"/>
              <path d="M24 32V40" stroke="#A67851" stroke-width="2.53846" stroke-linecap="round"/>
              <path d="M16 12L32 12" stroke="#A67851" stroke-width="2.53846" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          )}
        </div>
        <div className="flex flex-col gap-0.5 min-w-0">
          <span className="text-xs sm:text-sm text-[#6a6a6a]">{label}</span>
          <h3 className="text-[18px] sm:text-[20px] font-semibold text-[var(--color-foreground)] leading-tight">
            {name}
          </h3>
        </div>
      </div>

      {/* 2. Flipped quotes for RTL: closing quote at start, opening at end */}
      <div className="flex min-w-0 flex-1 flex-row items-start gap-1 sm:gap-2 justify-center">
        <span className="text-2xl sm:text-[40px] font-serif leading-none text-[var(--color-primary)] shrink-0" aria-hidden>
          &rdquo;
        </span>
        <p className="flex-1 min-w-0 max-w-max text-[16px] sm:text-[20px] lg:text-[23px] leading-relaxed text-[#343434]">
          {bio}
        </p>
        <span className="text-2xl sm:text-[40px] font-serif leading-none text-[var(--color-primary)] shrink-0" aria-hidden>
          &ldquo;
        </span>
      </div>
    </div>
  );
};
